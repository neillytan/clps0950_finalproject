%--------------------------------------------------------------------------
% PsyToolBox Setup
%--------------------------------------------------------------------------

sca;
close all;
PsychDefaultSetup( 2 );
Screen( 'Preference' , 'SkipSyncTests' , 1 );


screens = Screen('Screens');
screenNumber = max(screens);
black = BlackIndex(screenNumber);

[window, windowRect] = PsychImaging('OpenWindow', screenNumber, black);
[screenXpixels, screenYpixels] = Screen( 'WindowSize' , window);

flowchart = imread('/Users/ntan/Documents/MATLAB/Flowchart.png');

%--------------------------------------------------------------------------
% Keyboard Stuff
%--------------------------------------------------------------------------

one = KbName( '1' );
two = KbName( '2' );
three = KbName( '3' );
four = KbName( '4' );
quit = KbName( 'x' );
resp_key = [];
code_array = [];
%fill this in later with .csv info


%--------------------------------------------------------------------------
% Slides
%--------------------------------------------------------------------------

% Display flowchart
% Adjust flowchart into position underneath center

flowXpos = (0.5 * screenXpixels) - 75;
flowYpos = (0.5 * screenYpixels) - 50; 

prevXpos = 0.75 * screenXpixels;
prevYpos = 50; 

Screen('FrameRect', window, 0, bbox);
DrawFormattedText(window, 'Sentence here.', 'center', 'center', black);

Screen('FrameRect', window, 0, bbox);
imageTexture = Screen( 'MakeTexture' , window, flowchart, 'flowXpos', 'flowYpos');
Screen( 'DrawTexture' , window, imageTexture, [], [], 0 );
Screen( 'Flip' , window)
KbStrokeWait;
sca;

% Add rectangle at upper right displaying the previous key presses
Screen('FrameRect', window, 0, bbox);
DrawFormattedText(window, 'Your previous codes: ', 'prevXpos', 'prevYpos',  black);

    
ifi = Screen( 'GetFlipInterval' , window);
numFrames = length(code_array);
presTime = numFrames*ifi;
    
hasAnswered = false;

while ~hasAnswered
   [keyIsDown,secs, keyCode] = KbCheck;
    if keyIsDown
       if keyCode(one)
          ShowCursor;
          %code to fill in
          %% add getChar()
       elseif keyCode(two)
          ShowCursor;
          %code to fill in            
       elseif keyCode(three)
          ShowCursor;
          %code to fill in 
       elseif keyCode(four)
          ShowCursor;
       elseif keycode(quit)
          ShowCursor;
          sca;
          return      
        end
    end
end
    
    
blank_time = WaitSecs( .5 );



